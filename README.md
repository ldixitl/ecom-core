# Проект *EcomCore*

## Описание

*EcomCore* — это основа для e-commerce приложений. Этот проект содержит базовые классы для работы с товарами и категориями, а также систему загрузки данных из JSON. В дальнейшем его можно использовать для создания интернет-магазинов с любым интерфейсом, включая веб-сайты и ботов.

### Реализованные функции:

#### Модели (`models.py`)
- **Класс `Product`** – описывает товар, включая название, описание, цену и количество.
- **Класс `Category`** – управляет категориями товаров, учитывает общее количество категорий и товаров.
- **Класс `Smartphone`** – наследуется от `Product`, добавляя характеристики смартфонов:  
  - Производительность (`efficiency`)  
  - Модель (`model`)  
  - Объём памяти (`memory`)  
  - Цвет (`color`)  
  - **Метод `__str__`** – возвращает строковое представление в формате:  
    `"Название (модель), цвет, память ГБ, цена руб. Остаток: количество шт."`
- **Класс `LawnGrass`** – наследуется от `Product`, описывает газонную траву:  
  - Страна производства (`country`)  
  - Срок прорастания (`germination_period`)  
  - Цвет (`color`)  
  - **Метод `__str__`** – возвращает строковое представление в формате:  
    `"Название, цвет, страна, прорастание, цена руб. Остаток: количество шт.""`
- **Метод `add_product`** – добавляет товар в категорию и обновляет счетчики.
- **Геттер `price` в `Product`** – обеспечивает безопасный доступ к цене товара.  
- **Сеттер `price` в `Product`** – позволяет менять цену товара с проверкой на корректность (не отрицательная, предупреждение о снижении).  
- **Геттер `products` в `Category`** – возвращает список товаров в виде строки с их ценой и количеством.  
- **Класс-метод `new_product`** – создаёт товар или обновляет количество и цену существующего товара.
- **Магический метод `__str__` в `Product`** – возвращает строковое представление товара в формате `Название продукта, 80 руб. Остаток: 15 шт.`
- **Магический метод `__str__` в `Category`** – возвращает строковое представление категории в формате `Название категории, количество продуктов: 200 шт.`
- **Магический метод `__add__` в `Product`** – позволяет складывать товары, получая полную стоимость всех товаров на складе.

#### Итератор (`CategoryIterator`)
- **Класс `CategoryIterator`** – позволяет перебирать товары в категории с использованием `for`.
- **Методы `__iter__` и `__next__`** – реализуют поддержку итерации.

#### Загрузка данных (`utils.py`)
- **Функция `read_json`** – загружает данные из JSON-файла.
- **Функция `create_objects_from_json`** – преобразует JSON в объекты `Category` и `Product`.

#### Тесты
- Тестирование моделей (`test_models.py`): проверка создания объектов и добавления товаров.
- Тестирование загрузки данных (`test_utils.py`): проверка чтения JSON и создания объектов.

## Установка
1. Клонируйте репозиторий:
```sh
git clone https://github.com/ldixitl/ecom-core.git
```
Используется Poetry для управления зависимостями. Убедитесь, что Poetry установлен.
После установки выполните:
2. Установите зависимости:
```sh
poetry install
```

## Использование
Для загрузки данных из JSON выполните:
```python
from src.utils import read_json, create_objects_from_json

data = read_json("products.json")
categories = create_objects_from_json(data)
print(categories)
```

Добавить или обновить товар:
```python
from src.models import Product

data = {"name": "Ноутбук", "description": "Игровой", "price": 120000, "quantity": 5}  
product = Product.new_product(data)  
```

Перебор товаров в категории с помощью итератора:
```python
from src.models import CategoryIterator

iterator = CategoryIterator(category)
for product in iterator:
    print(product)
```

## Тестирование
Для тестирования в проекте используются **pytest** и плагин **pytest-cov** для измерения покрытия кода тестами.

### Запуск тестов
Для запуска тестов используйте:
```bash
pytest
```

### Отчёт о покрытии кода
Для генерации отчёта о покрытии кода в формате HTML выполните:

```bash
pytest --cov=src --cov-report=html
```
После выполнения команда сгенерирует папку **htmlcov**, содержащую отчёт. 
Откройте файл **htmlcov/index.html** в браузере, чтобы просмотреть детализированный отчёт.

## Лицензия
Этот проект распространяется под [лицензией MIT](LICENSE).
